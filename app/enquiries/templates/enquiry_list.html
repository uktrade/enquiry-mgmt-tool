{% extends 'base.html' %}
{% load static %}
{% block main %}
<h2 class="govuk-heading-l">Enquiries</h2>
<div class="govuk-grid-row">

    <div class="govuk-grid-column-one-third">
    </div>

    <div class="govuk-grid-column-two-thirds">
        {% load rest_framework %}
        <article>
            <header class="collection-header">
                <!-- TODO: Add filter controls and data to header -->
                <div class="collection-header-row">
                    <div class="collection-header-intro">
                        <span class="big-number-of-enquiries">{{ count }}</span> enquiries
                        <a href="{% url 'enquiries-import' %}"
                            class="add-enquiries-button govuk-button govuk-button--secondary"
                            data-module="govuk-button">
                            Add enquiries
                        </a>
                    </div>
                    <!-- <div class="collection-filter-summary">Stage: New</div> -->
                </div>
                <!-- <div class="collection-header-row">
                        <span class="header-page-number">Page 1 of 5</span>
                    </div> -->
            </header>
            <ol class="entity-list">
                {% for result in results %}
                <li class="entity-list-item">
                    <div class="entity-enquiry">
                        <div class="entity-header">
                            <div class="entity-title">
                                <h3>
                                    <a class="entity-title-link"
                                        href="{% url 'enquiry-detail' result.id %}">{{ result.company_name }}</a>
                                </h3>
                            </div>
                            <div class="entity-badges">
                                <div class="entity-badges-list">
                                    <div class="entity-badges-item">
                                        <span>{% if result.enquiry_stage == "Awaiting response from Investor" %}{{ "Awaiting response" }}{% else %}{{ result.enquiry_stage }}{% endif %}</span>
                                    </div>
                                    <div class="entity-badges-item">
                                        <span>{% if result.owner %}{{ result.owner.user }} {%else%} {{ "Unassigned" }}
                                            {%endif%}</span>
                                    </div>
                                    <div class="entity-badges-item">
                                        <span>{{ result.country }}</span>
                                    </div>
                                </div>
                            </div>
                            <div class="entity-subtitle">
                                Date received {{ result.created }}
                            </div>
                        </div>
                        <div class="entity-content">
                            <div class="entity-content-list">
                                <div class="entity-content-item">
                                    <span class="list-item-label">Enquiry text</span>
                                    <span class="list-item-value">{{ result.enquiry_text }}</span>
                                </div>
                                <div class="entity-content-item">
                                    <span class="list-item-label">Date last updated</span>
                                    <span class="list-item-value">{{ result.modified }}</span>
                                </div>
                                <div class="entity-content-item">
                                    <span class="list-item-label">Call?</span>
                                    <span class="list-item-value">{{ result.enquirer.request_for_call }}</span>
                                </div>
                            </div>
                            <!-- <div class="collection-filter-summary">Stage: New</div> -->
                        </div>
                    </div>
                </li>
                {% endfor %}
            </ol>

            <hr class="govuk-section-break govuk-section-break--m govuk-section-break">

            <nav class="pagination">

                <ol class="pagination-list">
                    {%if previous is not None %}
                    <li class="pagination-list-item">
                        <a class="pagination-link" href="{{ previous }}">Previous</a>
                    </li>
                    {%endif%}

                    {% for page in page_range %}
                    {% if page|stringformat:"s" == current_page %}
                    <a class="pagination-link" href="{% url 'enquiry-list' %}?page={{ page }}">
                        <li class="pagination-list-item pagination-list-item-current">{{ page }}</li>
                    </a>
                    {% else %}
                    <a class="pagination-link" href="{% url 'enquiry-list' %}?page={{ page }}">
                        <li class="pagination-list-item">{{ page }}</li>
                    </a>
                    {% endif %}
                    {% endfor %}

                    {%if next is not None %}
                    <li class="pagination-list-item">
                        <a class="pagination-link" href="{{ next }}">Next</a>
                    </li>
                    {%endif%}
                </ol>
            </nav>
        </article>
    </div>
</div>
{% endblock main %}